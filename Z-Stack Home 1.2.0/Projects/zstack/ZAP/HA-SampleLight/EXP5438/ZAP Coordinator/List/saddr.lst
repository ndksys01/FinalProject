###############################################################################
#                                                                             #
# IAR C/C++ Compiler V5.60.5.50814/W32 for MSP430       08/Apr/2014  21:14:18 #
# Copyright 1996-2013 IAR Systems AB.                                         #
#                                                                             #
#    __rt_version  =  3                                                       #
#    __double_size =  32                                                      #
#    __reg_r4      =  free                                                    #
#    __reg_r5      =  free                                                    #
#    __pic         =  no                                                      #
#    __core        =  430X                                                    #
#    __data_model  =  small                                                   #
#    Source file   =  C:\Texas Instruments\Z-Stack Home                       #
#                     1.2.0\Components\services\saddr\saddr.c                 #
#    Command line  =  -f "C:\Texas Instruments\Z-Stack Home                   #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     Source\zap.cfg" (-DZAP_PHY_SPI=1                        #
#                     -DZAP_PHY_UART=!ZAP_PHY_SPI -DZAP_PHY_RESET_ZNP=TRUE    #
#                     -DZAP_ZNP_MT=FALSE -DZAP_APP_MSG=FALSE                  #
#                     -DZAP_SBL_PROXY=FALSE -DZAP_AUTO_CFG=TRUE               #
#                     -DZAP_AUTO_START=TRUE -DZAP_NV_RESTORE=FALSE            #
#                     -DLCD_SUPPORTED -DZAP_AF_DATA_REQ_FRAG=FALSE            #
#                     -DZAP_AF_DATA_REQ_AREQ=!ZAP_AF_DATA_REQ_FRAG            #
#                     -DZAP_ZDO_STARTUP_AREQ=TRUE -DZAP_AF_FUNC               #
#                     -DZAP_SAPI_FUNC -DZAP_SYS_FUNC -DZAP_UTIL_FUNC          #
#                     -DZAP_ZDO_FUNC -DSECURE=0 -DZG_SECURE_DYNAMIC=0         #
#                     "-DDEFAULT_CHANLIST=(uint32)0x00000800"                 #
#                     -DZDAPP_CONFIG_PAN_ID=0xFFFF -DPOLL_RATE=1000           #
#                     -DNWK_START_DELAY=100 -DMAX_BINDING_CLUSTER_IDS=4) -f   #
#                     "C:\Texas Instruments\Z-Stack Home                      #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\Tools\MSP5438\f8wZCL.cfg" (-DZCL_READ -DZCL_WRITE    #
#                     -DZCL_BASIC -DZCL_IDENTIFY -DZCL_ON_OFF                 #
#                     -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4          #
#                     -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10         #
#                     -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10        #
#                     -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING -DZCL_PRICING  #
#                     -DZCL_MESSAGE -DZCL_TUNNELING -DZCL_TOU                 #
#                     -DZCL_DEVICE_MGMT) "C:\Texas Instruments\Z-Stack Home   #
#                     1.2.0\Components\services\saddr\saddr.c" -D             #
#                     FEATURE_GREEN_POWER -D FEATURE_ENHANCED_BEACON -D       #
#                     ZAP_DEVICETYPE=ZG_DEVICETYPE_COORDINATOR -lC "C:\Texas  #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\ZAP Coordinator\List\" -lA           #
#                     "C:\Texas Instruments\Z-Stack Home                      #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\ZAP    #
#                     Coordinator\List\" --remarks --diag_suppress            #
#                     Pe001,Pe193,Pe236,Pe826 -o "C:\Texas                    #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\ZAP Coordinator\Obj\" --debug        #
#                     -D__MSP430F5438__ -e --double=32 --clib -I "C:\Texas    #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\" -I "C:\Texas Instruments\Z-Stack   #
#                     Home 1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\. #
#                     .\Source\" -I "C:\Texas Instruments\Z-Stack Home        #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     Source\" -I "C:\Texas Instruments\Z-Stack Home          #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\hal\target\MSP5438ZAP\" -I          #
#                     "C:\Texas Instruments\Z-Stack Home                      #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\hal\include\" -I "C:\Texas          #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\mac\includ #
#                     e\" -I "C:\Texas Instruments\Z-Stack Home               #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\mt\" -I "C:\Texas                   #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\osal\inclu #
#                     de\" -I "C:\Texas Instruments\Z-Stack Home              #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\osal\mcu\msp430\" -I "C:\Texas      #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\services\s #
#                     addr\" -I "C:\Texas Instruments\Z-Stack Home            #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\services\sdata\" -I "C:\Texas       #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\stack\af\" #
#                      -I "C:\Texas Instruments\Z-Stack Home                  #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\stack\nwk\" -I "C:\Texas            #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\stack\sapi #
#                     \" -I "C:\Texas Instruments\Z-Stack Home                #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\stack\sec\" -I "C:\Texas            #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\stack\sys\ #
#                     " -I "C:\Texas Instruments\Z-Stack Home                 #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\stack\zcl\" -I "C:\Texas            #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\stack\zdo\ #
#                     " -I "C:\Texas Instruments\Z-Stack Home                 #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\..\..\ #
#                     ..\..\..\Components\zmac\" -I "C:\Texas                 #
#                     Instruments\Z-Stack Home 1.2.0\Projects\zstack\ZAP\HA-S #
#                     ampleLight\EXP5438\..\..\..\..\..\Components\zmac\f8w\" #
#                      --core=430X --data_model=small -Ohz --multiplier=32    #
#                     --multiplier_location=4C0 --require_prototypes          #
#                     --hw_workaround=CPU40 --hw_workaround=CPU39             #
#    List file     =  C:\Texas Instruments\Z-Stack Home                       #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\ZAP    #
#                     Coordinator\List\saddr.lst                              #
#    Object file   =  C:\Texas Instruments\Z-Stack Home                       #
#                     1.2.0\Projects\zstack\ZAP\HA-SampleLight\EXP5438\ZAP    #
#                     Coordinator\Obj\saddr.r43                               #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\Z-Stack Home 1.2.0\Components\services\saddr\saddr.c
      1          /****************************************************************************
      2            Filename:       saddr.c
      3            Revised:        $Date: 2013-06-13 09:40:13 -0700 (Thu, 13 Jun 2013) $
      4            Revision:       $Revision: 34575 $
      5          
      6            Description:    Zigbee and 802.15.4 device address utility functions.
      7          
      8          
      9            Copyright 2005-2013 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          ****************************************************************************/
     39          
     40          /****************************************************************************
     41           * INCLUDES
     42           */
     43          #include "hal_types.h"
     44          #include "OSAL.h"
     45          #include "saddr.h"
     46          
     47          #if defined( CC26XX )
     48            #include "flash_JT.h"
     49          #endif /* CC26XX */
     50          
     51          /****************************************************************************
     52           * @fn          sAddrCmp
     53           *
     54           * @brief       Compare two device addresses.
     55           *
     56           * input parameters
     57           *
     58           * @param       pAddr1        - Pointer to first address.
     59           * @param       pAddr2        - Pointer to second address.
     60           *
     61           * output parameters
     62           *
     63           * @return      TRUE if addresses are equal, FALSE otherwise
     64           */

   \                                 In  segment CODE, align 2
     65          bool sAddrCmp(const sAddr_t *pAddr1, const sAddr_t *pAddr2)
   \                     sAddrCmp:
     66          {
     67            if (pAddr1->addrMode != pAddr2->addrMode)
   \   000000   5E4C0800     MOV.B   0x8(R12), R14
   \   000004   5E9D0800     CMP.B   0x8(R13), R14
   \   000008   1020         JNE     ??sAddrCmp_2
     68            {
     69              return FALSE;
     70            }
     71            else if (pAddr1->addrMode == SADDR_MODE_NONE)
   \   00000A   4E93         CMP.B   #0x0, R14
   \   00000C   0E24         JEQ     ??sAddrCmp_2
     72            {
     73              return FALSE;
     74            }
     75            else if (pAddr1->addrMode == SADDR_MODE_SHORT)
   \   00000E   6E93         CMP.B   #0x2, R14
   \   000010   0720         JNE     ??sAddrCmp_3
     76            {
     77              return (bool) (pAddr1->addr.shortAddr == pAddr2->addr.shortAddr);
   \   000012   AC9D0000     CMP.W   @R13, 0(R12)
   \   000016   0224         JEQ     ??sAddrCmp_4
   \   000018   4C43         MOV.B   #0x0, R12
   \   00001A   1001         RETA
   \                     ??sAddrCmp_4:
   \   00001C   5C43         MOV.B   #0x1, R12
   \   00001E   1001         RETA
     78            }
     79            else if (pAddr1->addrMode == SADDR_MODE_EXT)
   \                     ??sAddrCmp_3:
   \   000020   7E900300     CMP.B   #0x3, R14
   \   000024   0220         JNE     ??sAddrCmp_2
     80            {
     81              return (sAddrExtCmp(pAddr1->addr.extAddr, pAddr2->addr.extAddr));
   \   000026   ........     BRA     #sAddrExtCmp
     82            }
     83            else
     84            {
     85              return FALSE;
   \                     ??sAddrCmp_2:
   \   00002A   4C43         MOV.B   #0x0, R12
   \   00002C   1001         RETA
     86            }
     87          }
     88          
     89          /****************************************************************************
     90           * @fn          sAddrIden
     91           *
     92           * @brief       Check if two device addresses are identical.
     93           *
     94           *              This routine is virtually the same as sAddrCmp, which is used
     95           *              to determine if two different addresses are the same. However,
     96           *              this routine can be used to determine if an address is the
     97           *              same as a previously stored address. The key difference is in
     98           *              the former case, if the address mode is "none", then the
     99           *              assumption is that the two addresses can not be the same. But
    100           *              in the latter case, the address mode itself is being compared.
    101           *              So two addresses can be identical even if the address mode is
    102           *              "none", as long as the address mode of both addresses being
    103           *              compared is "none".
    104           *
    105           * input parameters
    106           *
    107           * @param       pAddr1        - Pointer to first address.
    108           * @param       pAddr2        - Pointer to second address.
    109           *
    110           * output parameters
    111           *
    112           * @return      TRUE if addresses are identical, FALSE otherwise
    113           */

   \                                 In  segment CODE, align 2
    114          bool sAddrIden(const sAddr_t *pAddr1, const sAddr_t *pAddr2)
   \                     sAddrIden:
    115          {
    116            // first check if the address modes are the same
    117            if (pAddr1->addrMode != pAddr2->addrMode)
   \   000000   5E4C0800     MOV.B   0x8(R12), R14
   \   000004   5E9D0800     CMP.B   0x8(R13), R14
   \   000008   1220         JNE     ??sAddrIden_2
    118            {
    119              // no, so no point in comparing any further
    120              return FALSE;
    121            }
    122            // the address modes are the same; check if there is no address
    123            else if (pAddr1->addrMode == SADDR_MODE_NONE)
   \   00000A   4E93         CMP.B   #0x0, R14
   \   00000C   0220         JNE     ??sAddrIden_3
    124            {
    125              // no address, so no need to compare any further as both addresses have the
    126              // same address mode but no address, so they are identical
    127              return TRUE;
   \   00000E   5C43         MOV.B   #0x1, R12
   \   000010   1001         RETA
    128            }
    129            // there's an address; check if it is short
    130            else if (pAddr1->addrMode == SADDR_MODE_SHORT)
   \                     ??sAddrIden_3:
   \   000012   6E93         CMP.B   #0x2, R14
   \   000014   0720         JNE     ??sAddrIden_4
    131            {
    132              // compare short addresses
    133              return (bool) (pAddr1->addr.shortAddr == pAddr2->addr.shortAddr);
   \   000016   AC9D0000     CMP.W   @R13, 0(R12)
   \   00001A   0224         JEQ     ??sAddrIden_5
   \   00001C   4C43         MOV.B   #0x0, R12
   \   00001E   1001         RETA
   \                     ??sAddrIden_5:
   \   000020   5C43         MOV.B   #0x1, R12
   \   000022   1001         RETA
    134            }
    135            // there's an address; check if it is extended
    136            else if (pAddr1->addrMode == SADDR_MODE_EXT)
   \                     ??sAddrIden_4:
   \   000024   7E900300     CMP.B   #0x3, R14
   \   000028   0220         JNE     ??sAddrIden_2
    137            {
    138              // compare extended addresses
    139              return (sAddrExtCmp(pAddr1->addr.extAddr, pAddr2->addr.extAddr));
   \   00002A   ........     BRA     #sAddrExtCmp
    140            }
    141            else // unknown error
    142            {
    143              return FALSE;
   \                     ??sAddrIden_2:
   \   00002E   4C43         MOV.B   #0x0, R12
   \   000030   1001         RETA
    144            }
    145          }
    146          
    147          /****************************************************************************
    148           * @fn          sAddrCpy
    149           *
    150           * @brief       Copy a device address.
    151           *
    152           * input parameters
    153           *
    154           * @param       pSrc         - Pointer to address to copy.
    155           *
    156           * output parameters
    157           *
    158           * @param       pDest        - Pointer to address of copy.
    159           *
    160           * @return      None.
    161           */

   \                                 In  segment CODE, align 2
    162          void sAddrCpy(sAddr_t *pDest, const sAddr_t *pSrc)
   \                     sAddrCpy:
    163          {
    164            pDest->addrMode = pSrc->addrMode;
   \   000000   5E4D0800     MOV.B   0x8(R13), R14
   \   000004   CC4E0800     MOV.B   R14, 0x8(R12)
    165          
    166            if (pDest->addrMode == SADDR_MODE_EXT)
   \   000008   7E900300     CMP.B   #0x3, R14
   \   00000C   0220         JNE     ??sAddrCpy_0
    167            {
    168              sAddrExtCpy(pDest->addr.extAddr, pSrc->addr.extAddr);
   \   00000E   ........     BRA     #sAddrExtCpy
    169            }
    170            else
    171            {
    172              pDest->addr.shortAddr = pSrc->addr.shortAddr;
   \                     ??sAddrCpy_0:
   \   000012   AC4D0000     MOV.W   @R13, 0(R12)
    173            }
    174          }
   \   000016   1001         RETA
    175          
    176          /****************************************************************************
    177           * @fn          sAddrExtCmp
    178           *
    179           * @brief       Compare two extended addresses.
    180           *
    181           * input parameters
    182           *
    183           * @param       pAddr1        - Pointer to first address.
    184           * @param       pAddr2        - Pointer to second address.
    185           *
    186           * output parameters
    187           *
    188           * @return      TRUE if addresses are equal, FALSE otherwise
    189           */

   \                                 In  segment CODE, align 2
    190          bool sAddrExtCmp(const uint8 * pAddr1, const uint8 * pAddr2)
   \                     sAddrExtCmp:
    191          {
    192            uint8 i;
    193          
    194            for (i = SADDR_EXT_LEN; i != 0; i--)
   \   000000   7E42         MOV.B   #0x8, R14
    195            {
    196              if (*pAddr1++ != *pAddr2++)
   \                     ??sAddrExtCmp_0:
   \   000002   7F4C         MOV.B   @R12+, R15
   \   000004   7F9D         CMP.B   @R13+, R15
   \   000006   0224         JEQ     ??sAddrExtCmp_1
    197              {
    198                return FALSE;
   \   000008   4C43         MOV.B   #0x0, R12
   \   00000A   1001         RETA
    199              }
    200            }
   \                     ??sAddrExtCmp_1:
   \   00000C   7E53         ADD.B   #0xff, R14
   \   00000E   F923         JNE     ??sAddrExtCmp_0
    201            return TRUE;
   \   000010   5C43         MOV.B   #0x1, R12
   \   000012   1001         RETA
    202          }
    203          
    204          /****************************************************************************
    205           * @fn          sAddrExtCpy
    206           *
    207           * @brief       Copy an extended address.
    208           *
    209           * input parameters
    210           *
    211           * @param       pSrc         - Pointer to address to copy.
    212           *
    213           * output parameters
    214           *
    215           * @param       pDest        - Pointer to address of copy.
    216           *
    217           * @return      pDest + SADDR_EXT_LEN.
    218           */

   \                                 In  segment CODE, align 2
    219          void *sAddrExtCpy(uint8 * pDest, const uint8 * pSrc)
   \                     sAddrExtCpy:
    220          {
    221            return osal_memcpy(pDest, pSrc, SADDR_EXT_LEN);
   \   000000   3E42         MOV.W   #0x8, R14
   \   000002   ........     BRA     #osal_memcpy
    222          }
    223          
    224          
    225          
    226          

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      4   sAddrCmp
        4   -> sAddrExtCmp
      4   sAddrCpy
        4   -> sAddrExtCpy
      4   sAddrExtCmp
      4   sAddrExtCpy
        4   -> osal_memcpy
      4   sAddrIden
        4   -> sAddrExtCmp


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      46  sAddrCmp
      24  sAddrCpy
      20  sAddrExtCmp
       6  sAddrExtCpy
      50  sAddrIden

 
 146 bytes in segment CODE
 
 146 bytes of CODE memory

Errors: none
Warnings: none
